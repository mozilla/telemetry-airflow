- name: deploy container locally
  hosts: localhost

  tasks:
    - name: create task definition
      shell: "{{ item }}"
      with_items:
        - docker stop $(docker ps -a -q)
        - docker-compose -f ansible/files/docker-compose.yml up -d
      environment:
        AWS_REGION: "{{ region }}"
        EMR_KEY_NAME: "{{ emr_key_name }}"
        EMR_RELEASE_LABLE: "{{ emr_release_label }}"
        EMR_FLOW_ROLE: "{{ emr_flow_role }}"
        EMR_SERVICE_ROLE: "{{ emr_service_role }}"
        EMR_INSTANCE_TYPE: "{{ emr_instance_type }}"
        SPARK_BUCKET: "{{ spark_bucket }}"
        AIRFLOW_BUCKET: "{{ airflow_bucket }} "
